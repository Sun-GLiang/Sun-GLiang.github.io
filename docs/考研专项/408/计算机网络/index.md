# 计算机网络

## 第1章 计算机网络体系

- 区分**传输时延**和**传播时延**：传播时延与传播介质、通信双方距离有关
  - 电路交换：传输时延小，但是不能保证数据无差错的传送
  - 报文交换和分组交换：传输时延大；分组交换的传输时延又小于报文交换
- 注意单位：B和b的转换
- 主机A给主机B发送数据的最高理论速率取决于：链路带宽、主机A的网卡速率、主机B的网卡速率中的最小者，是数据传输的瓶颈
- 网络协议三要素
  - 语法：数据与控制信息的格式（如何讲：传输数据的格式）
  > 例如：IPv4数据报的首部格式、TCP报文段格式
  - 语义：需要发出何种控制信息、完成何种动作、做出何种应答（讲什么：所要完成的功能）
  > 例如：TCP连接的三次握手时所执行的操作
  - 时序：执行各种操作的条件、时序关系等，即事件实现顺序的说明（信息交流的次序）
  > 例如：TCP连接的三次握手的时序关系
- 物理层只负责透明传输比特，不涉及流量控制的功能
- 网络层和传输层才有拥塞控制功能
- 数据链路层向上提供可靠的传输服务，保证了数据正确的顺序和完整性
- 会话层使用**检验点**使通信会话在通信失效时从检验点继续恢复通信，实现数据同步
- 表示层负责数据格式转换、数据加密解密
- 为网络层实体提供数据发送和接收功能及过程的是数据链路层
  > 下一层为上一层提供服务
- 各层的SAP说明（N层的SAP是N+1层可以访问N层服务的地方
  - 数据链路层的SAP是帧的“类型”字段（由LLC子层实现）
  - 网络层的SAP是IP数据报的“协议”字段
  - 传输层的SAP是“端口号”字段
  - 应用层的SAP是用户接口
- 


















## 传输层

### TCP

**TCP使用选择重传**

- A发送了N个报文段，其中第k个报文段丢失，其余N-1个报文段正确按序到达接收方B
    > 使用GBN时，A需要重传分组k以及所有后继分组k+1,k+2,...,N
    > 而TCP至多只需要重传一个报文段，即报文段k














## 应用层


### 不同应用层协议<font color="red">服务器端</font>使用的端口及传输层协议


指的是<font color="red">服务器端</font>的端口

| 应用层 | FTP控制连接 | FTP数据连接 | DNS | HTTP | SMTP | POP3 |
| ------ | ----------- | ----------- | --- | ---- | ---- | ---- |
| 协议   | TCP         | TCP         | UDP | TCP  | TCP  | TCP  |
| 端口号 | 21          | 20          | 53  | 80   | 25   | 110  |


### DNS

- 域名不区分大小写

- 域名向IP地址的转换
    > 形如y.ab.com，客户机为查询得到其IP地址，整个过程共需要发送8个UDP报文段：4个查询报文（第一次是客户机发送，其他三次都是本地域名服务器发送）、4个回答报文
    >> 但是若问到，本地域名服务器时，则当前只发送了3次查询报文

### FTP

- 交互式访问

- 允许客户指明文件类型、格式，允许文件有存储权限

- 在异构网络中的任何计算机之间传送文件

- C/S模式：一个服务器，多个客户进程
    - 服务器进程由两个部分组成：主进程（接收新的请求）、若干从属进程（处理单个请求）；二者间并发进行
        - 服务器必须追踪用户在远程目录树上的位置

- 控制连接：在会话期间一直存在

- 数据连接：数据传送完就关闭连接
    - 主动模式：服务器连接到客户端（客户端主动告诉服务器开放哪个端口）
    - 被动模式：客户端连接到服务器（客户端让服务器打开服务器的某个端口，然后客户端连接这个端口）

- 控制信息是外带传送的（分离的控制连接）



### 电子邮件

**发送邮件过程**

用户->(SMTP、TCP)邮件服务器->(SMTP、TCP)邮件服务器->(POP3或IMAP、TCP)用户代理

**MIME**

SMTP只能发送7位ASCII码，通过MIME，就可以将非ASCII码转化为ASCII码，再交由SMTP进行传送

**POP3**

- 接收方的邮件服务器中运行POP服务器程序，接收方的用户代理必须允许POP客户程序

### HTTP

- cookie可以在无状态的HTTP之上建立一个用户会话层

- HTTP是无状态的：同一个客户第二次访问同一个网站，服务器的响应与第一次相同

- HTTP是无连接的：通信双方在交换HTTP报文之前不需要先建立HTTP连接

- 连接方式
    - 非持续连接（HTTP/1.0）

    - 持续连接（HTTP/1.1）
        - 非流水线方式：每次请求一个对象，1个RTT
        - 流水线方式：请求所有对象，近乎1个RTT

- HTTP请求报文中常用的几个方法
    - GET：请求读取由URL标识的信息
    - HEAD：请求读取由URL标识的信息的首部
    - POST：给服务器添加信息（如注释）
    - CONNECT：代理服务器


